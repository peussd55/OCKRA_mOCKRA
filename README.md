# OCKRA & m-OCKRA μ¬ν„ μ‹¤ν—

κµ­μ  μ €λ„μ— κ²μ¬λ **OCKRA**(One-Class K-means with Randomly-projected features Algorithm)κ³Ό κ·Έ ν™•μ¥νμΈ **m-OCKRA**(weighted attribute selection κΈ°λ° κ°μ„  λ¨λΈ)λ¥Ό μ¬ν„ν•κΈ° μ„ν• μ‹¤ν— λ…ΈνΈλ¶μ„ μ •λ¦¬ν• μ €μ¥μ†μ…λ‹λ‹¤. μ›¨μ–΄λ¬λΈ” μ„Όμ„μ—μ„ μμ§‘λ λ‹¨μΌ ν΄λμ¤ μ •μƒ ν™λ™ λ°μ΄ν„°λ¥Ό κΈ°λ°μΌλ΅ μ΄μƒ μ§•ν›„λ¥Ό νƒμ§€ν•λ” μ μ°¨λ¥Ό λ‹¨κ³„λ³„λ΅ κµ¬μ„±ν–μΌλ©°, μ—°κµ¬ λ…ΈνΈλ¶κ³Ό λ°ν‘ μλ£λ¥Ό ν†µν•΄ μ‹¤ν— λ§¥λ½μ„ μ†μ‰½κ² νμ•…ν•  μ μλ„λ΅ κµ¬μ„±ν–μµλ‹λ‹¤.

---

## π› οΈ κΈ°μ  μ¤νƒ (Tech Stack)
<p>
  <img src="https://img.shields.io/badge/Python-3776AB?style=for-the-badge&logo=python&logoColor=white">
  <img src="https://img.shields.io/badge/pandas-150458?style=for-the-badge&logo=pandas&logoColor=white">
  <img src="https://img.shields.io/badge/scikit--learn-F7931E?style=for-the-badge&logo=scikitlearn&logoColor=white">
  <img src="https://img.shields.io/badge/Matplotlib-3776AB?style=for-the-badge&logo=matplotlib&logoColor=white">
</p>

## π‘¥ μ°Έμ—¬μΈμ› (Members)
<p>
  <img src="https://img.shields.io/badge/κ°λ°%20(Development)-1λ…-3776AB?style=flat-square&logo=github&logoColor=white">
  <img src="https://img.shields.io/badge/μ—°κµ¬%20(Research)-1λ…-EE4C2C?style=flat-square&logo=googlescholar&logoColor=white">
</p>

## 1. μ €μ¥μ† κµ¬μ„±
| νμΌ | μ„¤λ… |
| --- | --- |
| `OCKRA.ipynb` | OCKRA μ› λ…Όλ¬Έ μ μ°¨λ¥Ό κΈ°λ°μΌλ΅ ν• 5-Fold μ‹¤ν—, νλΌλ―Έν„° νƒμƒ‰, ν†µκ³„ κ²€μ •μ„ ν¬ν•¨ν•©λ‹λ‹¤. |
| `m-OCKRA.ipynb` | m-OCKRA μ•κ³ λ¦¬μ¦ μ¬ν„μ„ μ„ν• λ°μ΄ν„° μ „μ²λ¦¬, λ‹¤μ¤‘ νΉμ§• μ„ νƒ, κ°€μ¤‘μΉ μ•™μƒλΈ”, λ€ν‘ κ°μ²΄(MROs) μ¶”μ¶, Chebyshev μ μ‚¬λ„ κ³„μ‚°, μµμΆ… μ„±λ¥ ν‰κ°€ μ μ°¨λ¥Ό κµ¬ν„ν•©λ‹λ‹¤. |

---

## 2. λ°μ΄ν„°μ…‹ μ”μ•½
- **μ„Όμ„ ν•­λ©**: μμ΄λ΅/κ°€μ†λ„ ν‰κ· Β·ν‘μ¤€νΈμ°¨, μ‹¬λ°•, ν”Όλ¶€μ¨λ„, μ΄λ™ κ΄€λ ¨ μ§€ν‘ λ“± 26κ° μ—°μ†ν• ν”Όμ²λ¥Ό μ‚¬μ©ν•©λ‹λ‹¤.γ€F:OCKRA_mOCKRA/m-OCKRA.ipynbβ€ L31-L38γ€‘
- **μ›μ² λ°μ΄ν„°**: `Dataset/NCDS.csv`(μ •μƒ)μ™€ `Dataset/ACDS.csv`(μ΄μƒ) νμΌμ„ κ²°ν•©ν•μ—¬ FS-NCD, FS-NACD λ‘ κ°€μ§€ μ „μ²λ¦¬ λ°μ΄ν„°μ…‹μ„ μƒμ„±ν•©λ‹λ‹¤.
- **κµμ°¨ κ²€μ¦ ν΄λ” κµ¬μ΅°**: `FiveFoldCrossValidation/Fold{1..5}` μ•„λ `training.csv`, `testing.csv`λ¥Ό μ‚¬μ©ν•λ©°, m-OCKRA λ‹¨κ³„μ—μ„λ” ν΄λ” λ‚΄λ¶€μ— `projection/`, `MROs/`, `SimilarityResults_/`, `FinalResults_` ν•μ„ ν΄λ”κ°€ μμ°¨μ μΌλ΅ μƒμ„±λ©λ‹λ‹¤.


> β οΈ **κ²½λ΅ μμ •**: λ…ΈνΈλ¶μ—λ” λ΅μ»¬ Windows κ²½λ΅κ°€ ν•λ“μ½”λ”©λμ–΄ μμΌλ―€λ΅, μ‹¤ν— ν™κ²½μ— λ§μ¶° μ λ€/μƒλ€ κ²½λ΅λ¥Ό μ¬μ„¤μ •ν•΄μ•Ό ν•©λ‹λ‹¤.

---

## 3. OCKRA μ‹¤ν— νμ΄ν”„λΌμΈ
1. **λ¨λΈ μ •μ**: μ„μ νΉμ„± ν•μ„μ§‘ν•©μΌλ΅ `KMeans`λ¥Ό ν•™μµν•λ” 100κ° μ΄ν•μ λ¶„λ¥κΈ°λ¥Ό κµ¬μ„±ν•κ³ , ν΄λ¬μ¤ν„° μ¤‘μ‹¬κΉμ§€μ κ±°λ¦¬λ΅ μ μ‚¬λ„ μ μλ¥Ό κ³„μ‚°ν•©λ‹λ‹¤.
2. **λ°μ΄ν„° μ „μ²λ¦¬**: 60μ΄ κ°„κ²©μΌλ΅ μƒν”μ„ μ¶”μ¶ν•μ—¬ μ‹κ°„ μ¶• λ¶κ· ν•μ„ μ™„ν™”ν• λ’¤ `ANOM_COND` λΌλ²¨μ„ λ¶„λ¦¬ν•©λ‹λ‹¤.
3. **5-Fold ν•™μµ & μ €μ¥**: κ° ν΄λ“λ§λ‹¤ λ¨λΈμ„ ν›λ ¨ν• λ’¤ `ockra_model_fold{n}.pkl`λ΅ μ§λ ¬ν™”ν•©λ‹λ‹¤.
4. **ν‰κ°€ λ° λ΅κ·Έ**: μ μ‚¬λ„ μ„κ³„κ°’ 0.6μ„ μ‚¬μ©ν•΄ μ •ν™•λ„, μ •λ°€λ„, μ¬ν„μ¨, F1, AUCλ¥Ό κ³„μ‚°ν•κ³  ν΄λ“λ³„ κ²°κ³Όλ¥Ό λ„μ ν•©λ‹λ‹¤.
5. **ν•μ΄νΌνλΌλ―Έν„° νƒμƒ‰**: `n_classifiers β {25, 50, 100}`, `n_clusters β {5, β€¦, 50}` μ΅°ν•©μ„ νƒμƒ‰ν•κ³  κ²°κ³Όλ¥Ό `parameter_search_results.csv`μ— μ €μ¥ν•©λ‹λ‹¤.
6. **ν†µκ³„ κ²€μ •**: Friedman κ²€μ •μ„ ν†µν•΄ λ¶„λ¥κΈ° μμ™€ ν΄λ¬μ¤ν„° μκ°€ AUCμ— λ―ΈμΉλ” ν†µκ³„μ  μ μμ„±μ„ νμ•…ν•©λ‹λ‹¤.
7. **μ‹κ°ν™”**: μ„ νƒν• λ‘ ν”Όμ²μ— λ€ν•΄ K-means++ ν΄λ¬μ¤ν„°λ§ κ²°κ³Όλ¥Ό ν™•μΈν•  μ μμµλ‹λ‹¤.

---

## 4. m-OCKRA μ‹¤ν— νμ΄ν”„λΌμΈ
1. **λ°μ΄ν„° μ „μ²λ¦¬**: μ •μƒ/μ΄μƒ λ°μ΄ν„°λ¥Ό ν†µν•©ν•μ—¬ FS-NCD, FS-NACD μ„ΈνΈλ¥Ό λ§λ“¤κ³  κ²°μΈ΅μΉλ¥Ό μ κ±°ν•©λ‹λ‹¤.
2. **κ°λ³„ νΉμ§• μ„ νƒ**: Information Score(IS), Pearson Correlation(PC), Intra-Class Distance(ICD), Interquartile Range(IQR) λ„¤ κ°€μ§€ κΈ°μ¤€μΌλ΅ νΉμ§• μ μ λ° μμ„λ¥Ό μ‚°μ¶ν•©λ‹λ‹¤.
3. **κ°€μ¤‘μΉ μ§‘κ³„**: ν‰κ· , μ¤‘μ•™κ°’, μµλΉκ°’, Borda Countλ¥Ό μ΄μ©ν•΄ λ‹¤μ¤‘ νΉμ§• μ„ νƒ κ²°κ³Όλ¥Ό ν†µν•©ν•©λ‹λ‹¤.
4. **μ†μ„± ν¬μ μ•™μƒλΈ”**: κ° κ°€μ¤‘μΉ μ»¬λΌκ³Ό μ†μ„± μ(26β†’10) μ΅°ν•©λ§λ‹¤ ν™•λ¥ μ  μƒν”λ§μ„ 50ν λ°λ³µν•΄ κ°€μ¥ μμ£Ό μ„ νƒλ ν”Όμ²λ¥Ό ν¬μ λ°μ΄ν„°μ…‹μΌλ΅ μ €μ¥ν•©λ‹λ‹¤.
5. **λ€ν‘ κ°μ²΄(MROs) μ¶”μ¶**: RandomMiner μ „λµμΌλ΅ λ¶€νΈμ¤νΈλ© μƒν”μ—μ„ λ€ν‘ κ°μ²΄λ¥Ό μ„ μ •ν•κ³  μ΅°κ±΄λ³„ CSVλ΅ μ €μ¥ν•©λ‹λ‹¤.
6. **Chebyshev μ μ‚¬λ„ κ³„μ‚°**: Numbaλ΅ κ°€μ†ν• Chebyshev κ±°λ¦¬ κΈ°λ° μ μ‚¬λ„ ν•¨μλ¥Ό κµ¬ν„ν•κ³ , μ§‘κ³„ κ°€μ¤‘μΉ μƒμ„ νΉμ„±μΌλ΅ λ™μ  μ„κ³„μΉ(Ξ΄)λ¥Ό κ³„μ‚°ν•΄ ν΄λ“λ³„ μ μ‚¬λ„λ¥Ό μ‚°μ¶ν•©λ‹λ‹¤.
7. **ν΄λ“ ν‰κ· ν™”**: Foldλ³„ μ μ‚¬λ„ νμΌμ„ κ²°ν•©ν•΄ λΌλ²¨κ³Ό ν‰κ·  μ μ‚¬λ„λ¥Ό λ‹΄μ€ κ²°κ³Ό CSVλ¥Ό μƒμ„±ν•©λ‹λ‹¤.
8. **μµμΆ… μ„±λ¥ ν‰κ°€**: λ¨λ“  μ΅°ν•©μ ν‰κ·  μ μ‚¬λ„ νμΌμ„ μ¤μΊ”ν•μ—¬ μ •ν™•λ„, μ •λ°€λ„, μ¬ν„μ¨, F1, AUCλ¥Ό κ³„μ‚°ν•κ³ , μµκ³  AUC μ΅°ν•©μ ROC κ³΅μ„ μ„ μ‹κ°ν™”ν•©λ‹λ‹¤.

---

## 5. μ‹¤ν–‰ λ°©λ²•
1. **ν™κ²½ μ¤€λΉ„**
   ```bash
   conda create -n ockra python=3.10
   conda activate ockra
   pip install pandas numpy scikit-learn scipy matplotlib numba joblib notebook
   ```
2. **λ°μ΄ν„° λ°°μΉ**
   - `Dataset/`, `FiveFoldCrossValidation/` ν΄λ” κµ¬μ΅°λ¥Ό μ›λ³Έ λ…Όλ¬Έκ³Ό λ™μΌν•κ² λ§μ¶° λ‘ CSVλ¥Ό λ°°μΉν•©λ‹λ‹¤.
   - m-OCKRA λ‹¨κ³„μ—μ„ μƒμ„±λλ” `feature_selection/`, `projection/`, `MROs/` λ“±μ ν•μ„ λ””λ ‰ν„°λ¦¬λ” λ…ΈνΈλ¶ μ‹¤ν–‰ μ‹ μλ™μΌλ΅ μƒμ„±λ©λ‹λ‹¤.
3. **λ…ΈνΈλ¶ μ‹¤ν–‰ μμ„**
   1. `m-OCKRA.ipynb`μ *Feature Selection1~3* μ…€μ„ μ‹¤ν–‰ν•΄ κ°€μ¤‘μΉ νμΌμ„ μ¤€λΉ„ν•©λ‹λ‹¤.
   2. λ™μΌ λ…ΈνΈλ¶μ—μ„ **μ†μ„± ν¬μ β†’ MROs β†’ Chebyshev β†’ ν‰κ· ν™” β†’ μ„±λ¥ ν‰κ°€** μ…€μ„ μμ°¨ μ‹¤ν–‰ν•©λ‹λ‹¤.
   3. `OCKRA.ipynb`λ¥Ό μ—΄μ–΄ 5-Fold ν•™μµ, νλΌλ―Έν„° νƒμƒ‰, ν†µκ³„ κ²€μ •μ„ μν–‰ν•©λ‹λ‹¤.
4. **κ²°κ³Ό ν™•μΈ**
   - `parameter_search_results.csv`, `FS_*_Aggregated_Results.csv`, `Final_Results_Summary.csv` λ“±μ μ‚°μ¶λ¬Όμ„ ν™μ©ν•΄ λ³΄κ³ μ„ λλ” λ°ν‘ μλ£μ— ν•„μ”ν• μμΉλ¥Ό μ •λ¦¬ν•©λ‹λ‹¤.

---

## 6. κ²°κ³Ό μ”μ•½ λ° ν™μ© ν
- **νλΌλ―Έν„° νƒμƒ‰ κ²°κ³Ό**: κ° μ΅°ν•©μ ν‰κ·  μ„±λ¥μ΄ `parameter_search_results.csv`μ— κΈ°λ΅λλ©°, Friedman κ²€μ • κ²°κ³Όλ¥Ό ν†µν•΄ μ΅°ν•© κ°„ μ μλ―Έν• μ°¨μ΄λ¥Ό κ²€ν† ν•  μ μμµλ‹λ‹¤.
- **μµμ  μ΅°ν•© νƒμƒ‰**: m-OCKRA μ‹¤ν—μ—μ„λ” `Final_Results_Summary.csv`μ—μ„ μµκ³  AUC μ΅°ν•©κ³Ό ROC κ³΅μ„ μ„ λ°”λ΅ ν™•μΈν•  μ μμµλ‹λ‹¤.

---

## 7. ν–¥ν›„ κ°μ„  μ•„μ΄λ””μ–΄
- μ†μ„± μ/λ€ν‘ κ°μ²΄ λΉ„μ¨ μ΅°ν•©μ΄ λ°©λ€ν•λ―€λ΅, **λ³‘λ ¬ μ²λ¦¬** λλ” **μƒν”λ§ μ „λµ**μ„ λ„μ…ν•΄ μ‹¤ν— μ‹κ°„μ„ λ‹¨μ¶•ν•  μ μμµλ‹λ‹¤.
- Chebyshev μ„κ³„μΉ κ³„μ‚° μ‹ μ‚¬μ©ν• λ‹¨μ ν•© λ€μ‹ , **μ •κ·ν™”λ κ°€μ¤‘μΉ ν‰κ· **μ΄λ‚ **Bayesian μµμ ν™”**λ¥Ό μ μ©ν•λ©΄ λ³΄λ‹¤ μ•μ •μ μΈ κΈ°μ¤€κ°’μ„ μ–»μ„ μ μμµλ‹λ‹¤.
- `parameter_search_results.csv`μ™€ `Final_Results_Summary.csv`λ¥Ό ν†µν•© λ¶„μ„ν•μ—¬ **ν†µν•© ν•μ΄νΌνλΌλ―Έν„° μ¶”μ² λ€μ‹λ³΄λ“**λ¥Ό κµ¬μ„±ν•΄ λ³΄μ„Έμ”.

---

<img width="1152" height="515" alt="ν™”λ©΄ μΊ΅μ² 2025-10-18 201157" src="https://github.com/user-attachments/assets/589343d8-9dd7-4824-b3f8-7889c9fa7d53" />
<img width="1143" height="512" alt="ν™”λ©΄ μΊ΅μ² 2025-10-18 201224" src="https://github.com/user-attachments/assets/26d3f5f0-4965-4b0f-b924-c59a2a9dfc2b" />  
<img width="1147" height="526" alt="ν™”λ©΄ μΊ΅μ² 2025-10-18 201407" src="https://github.com/user-attachments/assets/4405cf6f-8522-4da6-965b-d698aaec9480" />


